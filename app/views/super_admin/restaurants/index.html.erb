<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurant Management</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary-color: #4e73df;
      --secondary-color: #1cc88a;
      --warning-color: #f6c23e;
      --danger-color: #e74a3b;
      --info-color: #36b9cc;
      --dark-color: #5a5c69;
      --light-color: #f8f9fc;
    }
    
    body {
      background-color: var(--light-color);
      font-family: "Rubik", sans-serif;
}
    
    .page-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, #224abe 100%);
      color: white;
      padding: 2rem 0;
      margin-bottom: 2rem;
      border-radius: 0 0 0.5rem 0.5rem;
    }
    
    .restaurant-card {
      border: none;
      border-radius: 0.5rem;
      box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
      transition: transform 0.2s;
      overflow: hidden;
    }
    
    .restaurant-card:hover {
      transform: translateY(-5px);
    }
    
    .restaurant-header {
      background: linear-gradient(to right, rgba(78, 115, 223, 0.1), rgba(78, 115, 223, 0.05));
      border-bottom: 1px solid rgba(78, 115, 223, 0.2);
      padding: 1.25rem;
    }
    
    .restaurant-title {
      color: var(--dark-color);
      font-weight: 700;
      margin-bottom: 0;
      display: flex;
      align-items: center;
    }
    
    .restaurant-title i {
      margin-right: 0.75rem;
      color: var(--primary-color);
    }
    
    .section-card {
      border: 1px solid rgba(0,0,0,.125);
      border-radius: 0.5rem;
      margin-bottom: 1.25rem;
      background-color: white;
    }
    
    .section-header {
      padding: 0.75rem 1.25rem;
      background-color: rgba(0,0,0,.03);
      border-bottom: 1px solid rgba(0,0,0,.125);
      font-weight: 600;
      color: var(--dark-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .section-header i {
      margin-right: 0.5rem;
      color: var(--primary-color);
    }
    
    .section-body {
      padding: 1.25rem;
    }
    
    .badge-table-count {
      background-color: var(--primary-color);
      color: white;
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
    }
    
    .menu-item {
      border-left: 3px solid var(--secondary-color);
    }
    
    .menu-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .menu-price {
      background-color: var(--secondary-color);
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
    }
    
    .review-card {
      border-left: 3px solid var(--info-color);
      margin-top: 0.75rem;
      padding-left: 0.75rem;
    }
    
    .star-rating {
      color: var(--warning-color);
    }
    
    .reviewer {
      font-size: 0.8rem;
      color: var(--dark-color);
      font-style: italic;
      text-align: right;
      margin-top: 0.25rem;
    }
    
    .order-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .order-status {
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .order-status.pending {
      background-color: var(--warning-color);
      color: #212529;
    }
    
    .order-status.completed {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .order-status.cancelled {
      background-color: var(--danger-color);
      color: white;
    }
    
    .order-id {
      font-weight: 600;
      color: var(--primary-color);
    }
    
    .order-amount {
      font-weight: 600;
    }
    
    .no-data-message {
      color: #6c757d;
      font-style: italic;
      padding: 1rem;
      text-align: center;
      background-color: rgba(0,0,0,.03);
      border-radius: 0.25rem;
    }
    .restaurant_header{
      margin: 120px;
      margin-top: 20px;
      border-radius: 0.5rem;
    }
    .stat-card {
      border-radius: 0.35rem;
      border: 1px solid rgba(0,0,0,.125);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      height: fit-content;
      background-color: white;
      transition: transform 0.3s ease;
    }
    
    .stat-card .stat-number {
      font-size: 2rem;
      font-weight: 700;
      color: var(--dark-color);
    }
    
    .stat-card .stat-label {
      font-size: 0.875rem;
      color: #858796;
      text-transform: uppercase;
      font-weight: 600;
      margin-bottom: 0;
    }
    
    .stat-card .icon {
      font-size: 2rem;
      opacity: 0.3;
    }
    
  </style>
</head>
<body>
  <div class="container-fluid mb-5">
    <div class="row page-header mb-4 restaurant_header">
      <div class="col-12 text-center">
        <h1><i class="fas fa-utensils"></i> Restaurant Management</h1>
        <p class="lead">View and manage all restaurant details</p>
      </div>
    </div>
    
    <div class="row">
      <div class="col-lg-10 mx-auto">
        <% @restaurants.each do |restaurant| %>
          <div class="restaurant-card card mb-4">
            <div class="restaurant-header">
              <h2 class="restaurant-title">
                <i class="fas fa-store"></i>
                <%= restaurant.restaurant_name %>
              </h2>
            </div>
            <div class="card-body">
              <div class="row">
               
                <div class="col-xl-4 col-md-6 mb-4">
                  <div class="stat-card primary">
                    <div class="row no-gutters align-items-center">
                      <div class="col mr-2">
                        <div class="stat-label mb-1">Total Tables</div>
                        <div class="stat-number"><%= restaurant.restaurant_tables.count %></div>
                      </div>
                      <div class="col-auto">
                        <i class="fas fa-users icon text-primary"></i>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="col-md-8 mb-4">
                  <div class="section-card">
                    <div class="section-header">
                      <div>
                        <i class="fas fa-book-open"></i> Menu Items
                      </div>
                    </div>
                    <div class="section-body">
                      <div class="accordion" id="menuAccordion<%= restaurant.id %>">
                        <% restaurant.menu_items.each_with_index do |menu_item, index| %>
                          <div class="accordion-item menu-item mb-3">
                            <h2 class="accordion-header" id="menuHeading<%= restaurant.id %>_<%= index %>">
                              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#menuCollapse<%= restaurant.id %>_<%= index %>" aria-expanded="false" aria-controls="menuCollapse<%= restaurant.id %>_<%= index %>">
                                <div class="menu-item-header w-100 d-flex justify-content-between align-items-center">
                                  <strong><%= menu_item.item_name %></strong>
                                  <span class="menu-price ms-2">â‚¹ <%= menu_item.price %></span>
                                </div>
                              </button>
                            </h2>
                            <div id="menuCollapse<%= restaurant.id %>_<%= index %>" class="accordion-collapse collapse" aria-labelledby="menuHeading<%= restaurant.id %>_<%= index %>" data-bs-parent="#menuAccordion<%= restaurant.id %>">
                              <div class="accordion-body">
                                <% if menu_item.reviews.any? %>
                                  <h6 class="mb-3"><i class="fas fa-star text-warning"></i> Customer Reviews</h6>
                                  <% menu_item.reviews.each do |review| %>
                                    <div class="review-card mb-3">
                                      <div class="star-rating">
                                        <% review.rating.to_i.times do %>
                                          <i class="fas fa-star"></i>
                                        <% end %>
                                        <% (5 - review.rating.to_i).times do %>
                                          <i class="far fa-star"></i>
                                        <% end %>
                                      </div>
                                      <p class="mb-1 mt-2"><%= review.comment %></p>
                                      <div class="reviewer">
                                        <i class="fas fa-user-circle"></i> <%= review.user.first_name %> <%= review.user.last_name %>
                                      </div>
                                    </div>
                                  <% end %>
                                <% else %>
                                  <div class="no-data-message">
                                    <i class="fas fa-info-circle me-2"></i> No reviews yet
                                  </div>
                                <% end %>
                              </div>
                            </div>
                          </div>
                        <% end %>
                        
                        <% if restaurant.menu_items.empty? %>
                          <div class="no-data-message">
                            <i class="fas fa-utensils me-2"></i> No menu items available
                          </div>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Orders Section -->
                <div class="col-12">
                  <div class="section-card">
                    <div class="section-header">
                      <div>
                        <i class="fas fa-shopping-cart"></i> Orders
                      </div>
                    </div>
                    <div class="section-body">
                      <% if restaurant.orders.any? %>
                        <div class="table-responsive">
                          <table class="table table-hover table-striped">
                            <thead>
                              <tr>
                                <th scope="col">Order ID</th>
                                <th scope="col">Amount</th>
                                <th scope="col">Status</th>
                                <th scope="col">Placed By</th>
                                <th scope="col">Date & Time</th>
                              </tr>
                            </thead>
                            <tbody>
                              <% restaurant.orders.each do |order| %>
                                <tr>
                                  <td class="order-id">#Order<%= order.id %></td>
                                  <td class="order-amount"> â‚¹  <%= order.order_amount %></td>
                                  <td>
                                    <% status_class = case order.order_status.downcase
                                         when 'pending' then 'pending'
                                         when 'completed' then 'completed'
                                         else 'cancelled'
                                       end %>
                                    <span class="order-status <%= status_class %>">
                                      <%= order.order_status %>
                                    </span>
                                  </td>
                                  <td>
                                    <%= order.user.first_name %> <%= order.user.last_name %>
                                  </td>
                                  <td>
                                    <%= order.created_at.to_date.to_s %>
                                  </td>
                                </tr>
                              <% end %>
                            </tbody>
                          </table>
                        </div>
                      <% else %>
                        <div class="no-data-message">
                          <i class="fas fa-info-circle me-2"></i> No orders available
                        </div>
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>
</html>
